{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\03yuk\\\\Desktop\\\\private\\\\react\\\\shift-reserch3\\\\client\\\\src\\\\Home.js\";\nimport React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport Calendar from 'react-calendar';\nimport Modal from 'react-modal';\nimport './css/Home.css';\nimport { withStyles } from '@material-ui/core/styles';\nimport TextField from '@material-ui/core/TextField';\nimport SettingIcon from '@material-ui/icons/SettingsApplications';\nconst customStyles = {\n  content: {\n    top: '50%',\n    left: '50%',\n    right: 'auto',\n    bottom: 'auto',\n    marginRight: '-50%',\n    transform: 'translate(-50%, -50%)'\n  },\n  formcontrol: {\n    fontSize: '10px'\n  }\n};\nconst calendarstyle = {\n  content: {\n    display: 'inline-block'\n  }\n};\nconst CssTextField = withStyles({\n  root: {\n    '& label.Mui-focused': {\n      color: '#20C2D3'\n    },\n    '& .MuiOutlinedInput-root': {\n      '&.Mui-focused fieldset': {\n        borderColor: '#20C2D3'\n      }\n    }\n  }\n})(TextField);\nModal.setAppElement('#root');\n\nclass Home extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      userdata: [],\n      //ユーザー情報\n      date: new Date(),\n      //today\n      receptionDate: new Date(),\n      //受付中\n      stamp: \"x\",\n      //シフトに記入する文字\n      stamptime: \"\",\n      //時間希望\n      deadline: \"\",\n      //締め切り\n      default_month_days: [],\n      //defaultのシフト情報\n      month_days: [],\n      //更新されるシフト情報\n      shifttimes: [\"09:00\", \"09:30\", \"10:00\", \"10:30\", \"11:00\", \"11:30\", \"12:00\", \"12:30\", \"13:00\", \"13:30\", \"14:00\", \"14:30\", \"15:00\", \"15:30\", \"16:00\", \"16:30\", \"17:00\", \"17:30\", \"18:00\", \"18:30\", \"19:00\", \"19:30\", \"20:00\", \"20:30\", \"21:00\", \"21:30\", \"22:00\", \"22:30\", \"23:00\", \"23:30\", \"23:45\"],\n      //選択可能時間\n      startTime: \"09:00\",\n      endTime: \"09:00\",\n      complementdaysText: \"\",\n      wishdays: [\"\", 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16],\n      //選択希望日数\n      default_comments: [],\n      //defaultのコメント\n      comments: [],\n      //dbから\n      wishday: \"\",\n      //希望日数\n      comment: \"\",\n      //希望コメント\n      nowprintcommentday: \"\",\n      modalIsOpen: false,\n      //モーダル判定\n      isUpdateshift: [] //シフト更新\n\n    };\n    this.setdefaultshifts = this.setdefaultshifts.bind(this);\n    this.setdefaultcomment = this.setdefaultcomment.bind(this);\n    this.getDateReception = this.getDateReception.bind(this);\n    this.dayspreOnclick = this.dayspreOnclick.bind(this);\n    this.daysbackOnclick = this.daysbackOnclick.bind(this);\n    this.dayspreback = this.dayspreback.bind(this);\n    this.wishdayOnchange = this.wishdayOnchange.bind(this);\n    this.commentOnchange = this.commentOnchange.bind(this);\n    this.openModal = this.openModal.bind(this);\n    this.afterOpenModal = this.afterOpenModal.bind(this);\n    this.closeModal = this.closeModal.bind(this);\n    this.setShiftTime = this.setShiftTime.bind(this);\n    this.startTimeChange = this.startTimeChange.bind(this);\n    this.endTimeChange = this.endTimeChange.bind(this);\n    this.addDataOnClick = this.addDataOnClick.bind(this);\n    this.shiftupdateChecker = this.shiftupdateChecker.bind(this);\n  }\n\n  componentDidMount() {\n    this.getDateReception(); //ユーザーデータ取得\n\n    fetch('/userdata') //fetch('/testuserdata')\n    .then(res => res.json()).then(data => this.setState({\n      userdata: data\n    })); //シフトデータ取得\n\n    fetch('/shiftdata') //fetch('/testshiftdata')\n    .then(res => res.json()).then(data => this.setdefaultshifts(data)); //コメントデータ取得\n\n    fetch('/getcommentdata') //fetch('/testgetcommentdata')\n    .then(res => res.json()).then(data => this.setdefaultcomment(data));\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, \"\\u30B7\\u30D5\\u30C8\\u5E0C\\u671B\"), \"\\u3088\\u3046\\u3053\\u305D\", this.state.userdata.username, \"\\u3055\\u3093\", React.createElement(Link, {\n      to: \"/Setting\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }, React.createElement(SettingIcon, {\n      style: {\n        margin: '5px',\n        fontSize: '30px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    })), React.createElement(\"a\", {\n      href: \"/logout\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }, \"\\u30ED\\u30B0\\u30A2\\u30A6\\u30C8\"), React.createElement(\"h2\", {\n      className: \"reception\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, this.state.receptionDate.getFullYear(), \" \", this.state.receptionDate.getMonth() + 1, \"\\u6708\", this.state.receptionDate.getDate(), \"\\u65E5\\uFF5E\\u53D7\\u4ED8\\u4E2D\"), React.createElement(\"div\", {\n      id: \"dateText\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, this.state.deadline), React.createElement(\"button\", {\n      className: \"wishbutton\",\n      id: \"batu\",\n      onClick: this.onClickstamp.bind(this, \"x\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }, \"\\u2715\"), React.createElement(\"button\", {\n      className: \"wishbutton\",\n      id: \"sankaku\",\n      onClick: this.onClickstamp.bind(this, \"△\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, \"\\u25B3\"), React.createElement(\"button\", {\n      className: \"wishbutton\",\n      id: \"timeset\",\n      onClick: this.onClickstamp.bind(this, \"time\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, \"\\u6642\\u9593\\u6307\\u5B9A\"), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      id: \"calendar\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }, React.createElement(Calendar, {\n      locale: \"ja-JP\",\n      calendarType: \"US\",\n      value: this.state.receptionDate,\n      tileContent: this.getTileContent.bind(this),\n      onChange: value => this.dayClick(value),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"flame\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }, \"\\u88DC\\u8DB3\\u5E0C\\u671B:\", this.state.complementdaysText, React.createElement(\"button\", {\n      onClick: this.dayspreOnclick,\n      className: \"wishbutton\",\n      id: \"prevwish\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }, \"\\u25C1\"), React.createElement(\"button\", {\n      onClick: this.daysbackOnclick,\n      className: \"wishbutton\",\n      id: \"backwish\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }, \"\\u25B7\"), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      id: \"wishday\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    }, \"\\u5E0C\\u671B\\u51FA\\u52E4\\u65E5\\u6570\\uFF1A\", React.createElement(\"select\", {\n      onChange: this.wishdayOnchange,\n      value: this.state.wishday,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, this.state.wishdays.map(days => React.createElement(\"option\", {\n      key: days,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }, days))), \"\\u65E5\"), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }, React.createElement(CssTextField, {\n      id: \"outlined-name\",\n      label: \"\\u8FFD\\u8A18\",\n      value: this.state.comment,\n      onChange: this.commentOnchange,\n      margin: \"normal\",\n      variant: \"outlined\",\n      placeholder: \"\\u5E0C\\u671B\\u3092\\u8A18\\u5165\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      id: \"submit_shiftdata\",\n      onClick: this.addDataOnClick,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }, \"\\u767B\\u9332\"))), React.createElement(Modal, {\n      isOpen: this.state.modalIsOpen,\n      onAfterOpen: this.afterOpenModal,\n      onRequestClose: this.closeModal,\n      style: customStyles,\n      contentLabel: \"worktime Modal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, \"\\u51FA\\u52E4\\u53EF\\u80FD\\u6642\\u9593\\u3092\\u9078\\u629E\"), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }, React.createElement(\"select\", {\n      onChange: this.startTimeChange,\n      value: this.state.startTime,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }, this.state.shifttimes.map(time => React.createElement(\"option\", {\n      key: time,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }, time))), \"\\uFF5E\", React.createElement(\"select\", {\n      onChange: this.endTimeChange,\n      value: this.state.endTime,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, this.state.shifttimes.map(time => React.createElement(\"option\", {\n      key: time,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, time)))), React.createElement(\"button\", {\n      onClick: this.closeModal,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, \"\\u9589\\u3058\\u308B\"), React.createElement(\"button\", {\n      onClick: this.setShiftTime,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }, \"\\u6C7A\\u5B9A\")));\n  }\n\n  getintdate(year, month, day) {\n    return year + (\"0\" + (month + 1)).slice(-2) + (\"0\" + day).slice(-2);\n  } //json変換\n\n\n  setdefaultshifts(data) {\n    const deflist = [];\n    const list = [];\n\n    for (let shift of data) {\n      list[shift.date] = {\n        text: shift.detail\n      };\n      deflist[shift.date] = {\n        text: shift.detail\n      };\n    }\n\n    this.setState({\n      default_month_days: deflist,\n      month_days: list\n    });\n  } //commentSetting\n\n\n  setdefaultcomment(data) {\n    if (data !== \"\") {\n      const deflist = [];\n      const list = [];\n\n      for (const comment of data) {\n        const date = new Date(comment.date);\n        const num = date.getFullYear() + (\"0\" + (date.getMonth() + 1)).slice(-2) + (\"0\" + date.getDate()).slice(-2);\n        list[num] = {\n          comment: comment.text,\n          wishday: comment.wishday\n        };\n        deflist[num] = {\n          comment: comment.text,\n          wishday: comment.wishday\n        };\n      } //締め切りの初期コメント設定\n\n\n      const recepdate = this.state.receptionDate;\n      const firstdate = recepdate.getFullYear() + (\"0\" + (recepdate.getMonth() + 1)).slice(-2) + (\"0\" + recepdate.getDate()).slice(-2);\n      let com = \"\";\n      let wish = \"\";\n\n      if (list[firstdate] != null) {\n        com = list[firstdate].comment;\n        wish = list[firstdate].wishday;\n      }\n\n      this.setState({\n        default_comments: deflist,\n        comments: list,\n        comment: com,\n        wishday: wish,\n        nowprintcommentday: firstdate\n      });\n    }\n  }\n\n  getFormatDate(date) {\n    return \"\".concat(date.getFullYear()).concat(('0' + (date.getMonth() + 1)).slice(-2)).concat(('0' + date.getDate()).slice(-2));\n  } //受付中日にち\n\n\n  getDateReception() {\n    let year = this.state.date.getFullYear();\n    let month = this.state.date.getMonth() + 1;\n    const day = this.state.date.getDate();\n    let receptionday = \"\";\n    let deadline = \"\";\n    let setday = \"\";\n\n    if (day <= 10) {\n      //締め切り\n      const finaldate = new Date(year, month, 0);\n      receptionday = month + \"/16～\" + month + \"/\" + finaldate.getDate();\n      deadline = month + \"/10まで(\" + receptionday + \")\"; //今月16～末日まで\n\n      setday = year + \"/\" + month + \"/16\";\n    } else if (day > 24) {\n      //年越し処理\n      if (month === 12) {\n        year++;\n        month = 0;\n      } //締め切り\n\n\n      const finaldate = new Date(year, month, 0);\n      receptionday = month + 1 + \"/16～\" + (month + 1) + \"/\" + finaldate.getDate();\n      deadline = month + 1 + \"/10まで(\" + receptionday + \")\"; //来月16～末日\n\n      setday = year + \"/\" + (month + 1) + \"/16\";\n    } else {\n      //年越し処理\n      if (month === 12) {\n        year++;\n        month = 0;\n      } //締め切り\n\n\n      receptionday = month + 1 + \"/1～\" + (month + 1) + \"/15\";\n      deadline = month + \"/24まで(\" + receptionday + \")\"; //来月1～15まで\n\n      setday = year + \"/\" + (month + 1) + \"/1\";\n    }\n\n    this.setState({\n      complementdaysText: receptionday,\n      deadline: deadline,\n      receptionDate: new Date(setday)\n    });\n  }\n\n  getTileContent({\n    date,\n    view\n  }) {\n    // 月表示のときのみ\n    if (view !== 'month') {\n      return null;\n    }\n\n    const day = this.getFormatDate(date);\n    return React.createElement(\"p\", {\n      className: \"calendaritem\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293\n      },\n      __self: this\n    }, this.state.month_days[day] && this.state.month_days[day].text ? this.state.month_days[day].text : '  ');\n  } //スタンプ変換\n\n\n  onClickstamp(value) {\n    this.setState({\n      stamp: value\n    });\n  } //日付クリック\n\n\n  dayClick(value) {\n    //受付中か\n    if (this.state.receptionDate <= value) {\n      const dayslist = this.state.month_days;\n      const clickday = value.getFullYear() + (\"0\" + (value.getMonth() + 1)).slice(-2) + (\"0\" + value.getDate()).slice(-2);\n      this.setState({\n        clickdate: clickday\n      }); //空or重複判定\n\n      if (null == dayslist[clickday] || \"\" === dayslist[clickday].text) {\n        //stampが記号か日付で分岐\n        if (this.state.stamp === \"time\") {\n          this.openModal();\n        } else {\n          dayslist[clickday] = {\n            text: this.state.stamp\n          };\n          this.setState({\n            month_days: dayslist\n          });\n        } //stamp一致クリック\n\n      } else if (this.state.stamp === dayslist[clickday].text) {\n        dayslist[clickday] = {\n          text: \"\"\n        };\n        this.setState({\n          month_days: dayslist\n        });\n      } else if (this.state.stamp !== dayslist[clickday].text) {\n        //stampが記号か日付で分岐\n        if (this.state.stamp === \"time\") {\n          //this.openModal();\n          dayslist[clickday] = {\n            text: \"\"\n          };\n        } else {\n          dayslist[clickday] = {\n            text: this.state.stamp\n          };\n          this.setState({\n            month_days: dayslist\n          });\n        }\n      }\n    }\n  }\n\n  dayspreOnclick() {\n    //前へ処理\n    this.dayspreback(\"pre\");\n  }\n\n  daysbackOnclick() {\n    //後へ処理\n    this.dayspreback(\"back\");\n  }\n\n  dayspreback(str) {\n    this.state.comments[this.state.nowprintcommentday] = {\n      comment: this.state.comment,\n      wishday: this.state.wishday //nowprintcommentday\n\n    };\n    const printday = this.state.nowprintcommentday;\n    const datearr = (printday.substr(0, 4) + '/' + printday.substr(4, 2) + '/' + printday.substr(6, 2)).split('/');\n    const nowdate = new Date(datearr[0], datearr[1] - 1, datearr[2]);\n    let year = nowdate.getFullYear();\n    let month = nowdate.getMonth();\n    let day = nowdate.getDate();\n\n    if (str === \"pre\") {\n      if (day === 16) {\n        day = 1;\n      } else {\n        if (month === 0) {\n          year--;\n          month = 11;\n          day = 16;\n        } else {\n          month--;\n          day = 16;\n        }\n      }\n    } else if (str === \"back\") {\n      //\n      if (day === 1) {\n        day = 16;\n      } else {\n        if (month === 11) {\n          year++;\n          month = 0;\n          day = 1;\n        } else {\n          month++;\n          day = 1;\n        }\n      }\n    } //complementdaysText\n\n\n    let text = \"\";\n\n    if (day === 16) {\n      const finaldate = new Date(year, month, 0);\n      text = month + 1 + \"/\" + day + \"～\" + (month + 1) + \"/\" + finaldate.getDate();\n    } else {\n      text = month + 1 + \"/\" + day + \"～\" + (month + 1) + \"/\" + 15;\n    }\n\n    if (this.state.comments[this.getintdate(year, month, day)] == null) {\n      this.state.comments[this.getintdate(year, month, day)] = {\n        comment: \"\",\n        wishday: \"\"\n      };\n    }\n\n    this.setState({\n      comment: this.state.comments[this.getintdate(year, month, day)].comment,\n      wishday: this.state.comments[this.getintdate(year, month, day)].wishday,\n      nowprintcommentday: this.getintdate(year, month, day),\n      complementdaysText: text\n    });\n  }\n\n  wishdayOnchange(e) {\n    this.setState({\n      wishday: e.target.value\n    });\n  }\n\n  commentOnchange(e) {\n    this.setState({\n      comment: e.target.value\n    });\n  } //モーダル関連\n\n\n  openModal() {\n    this.setState({\n      modalIsOpen: true\n    });\n  }\n\n  afterOpenModal() {//モーダルオープン後処理\n  }\n\n  closeModal() {\n    this.setState({\n      modalIsOpen: false\n    });\n  }\n\n  setShiftTime() {\n    if (this.state.startTime >= this.state.endTime) {\n      alert(\"不可能な時間です\");\n    } else {\n      this.closeModal();\n      const dayslist = this.state.month_days;\n      dayslist[this.state.clickdate] = {\n        text: this.state.startTime + \"-\" + this.state.endTime\n      };\n      this.setState({\n        month_days: dayslist\n      });\n    }\n  }\n\n  startTimeChange(e) {\n    this.setState({\n      startTime: e.target.value\n    });\n  }\n\n  endTimeChange(e) {\n    this.setState({\n      endTime: e.target.value\n    });\n  } //登録ボタン\n\n\n  addDataOnClick() {\n    this.state.comments[this.state.nowprintcommentday] = {\n      comment: this.state.comment,\n      wishday: this.state.wishday\n    };\n    const defshift = this.state.default_month_days;\n    const newshift = this.state.month_days;\n    const newshiftdata = []; //追加されたシフト情報\n\n    for (let shiftday in newshift) {\n      if (defshift[shiftday] == null) {\n        newshiftdata[shiftday] = {\n          text: newshift[shiftday].text\n        };\n      }\n    } //削除されたシフト情報\n\n\n    const deleteshiftdata = [];\n\n    for (let shiftday in defshift) {\n      if (newshift[shiftday].text === \"\") {\n        deleteshiftdata[shiftday] = {\n          text: defshift[shiftday].text\n        };\n      }\n    } //更新されたシフト情報\n\n\n    const updateshiftdata = [];\n\n    for (let shiftday in newshift) {\n      if (defshift[shiftday] != null && newshift[shiftday].text !== \"\" && defshift[shiftday].text !== newshift[shiftday].text) {\n        updateshiftdata[shiftday] = {\n          text: newshift[shiftday].text\n        };\n      }\n    } //add\n\n\n    if (newshiftdata.length > 0) {\n      this.setState({\n        isUpdateshift: this.state.isUpdateshift.concat(\"add\")\n      });\n      this.dbUpdater('/addshiftdata', newshiftdata); //this.dbUpdater('/testaddshiftdata', newshiftdata);\n    } //delete\n\n\n    if (deleteshiftdata.length > 0) {\n      this.setState({\n        isUpdateshift: this.state.isUpdateshift.concat(\"delete\")\n      });\n      this.dbUpdater('/deleteshiftdata', deleteshiftdata); //this.dbUpdater('/testdeleteshiftdata', deleteshiftdata);\n    } //update\n\n\n    if (updateshiftdata.length > 0) {\n      this.setState({\n        isUpdateshift: this.state.isUpdateshift.concat(\"update\")\n      });\n      this.dbUpdater('/updateshiftdata', updateshiftdata); //this.dbUpdater('/testupdateshiftdata', updateshiftdata);\n    } //コメント更新\n    //差分配列add＆update配列生成のちfetch\n\n\n    const addcommentdata = [];\n\n    for (const com in this.state.comments) {\n      if (this.state.default_comments[com] == null) {\n        addcommentdata.push({\n          date: com,\n          comment: this.state.comments[com].comment,\n          wishday: this.state.comments[com].wishday\n        });\n      }\n    }\n\n    const updatecommentdata = [];\n\n    for (const com in this.state.default_comments) {\n      if (this.state.comments[com].comment !== this.state.default_comments[com].comment || this.state.comments[com].wishday !== this.state.default_comments[com].wishday) {\n        updatecommentdata.push({\n          date: com,\n          comment: this.state.comments[com].comment,\n          wishday: this.state.comments[com].wishday\n        });\n      }\n    }\n\n    fetch('/updatecommentdata', {\n      //fetch('/testupdatecommentdata', {\n      method: 'POST',\n      body: JSON.stringify(updatecommentdata),\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      mode: 'cors'\n    }).then(res => res.json());\n    fetch('/addcommentdata', {\n      //fetch('/testaddcommentdata', {\n      method: 'POST',\n      body: JSON.stringify(addcommentdata),\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      mode: 'cors'\n    }).then(res => res.json()).then(str => alert(\"登録しました\"));\n    this.shiftupdateChecker(\"\");\n  } //shiftDB更新用fetch\n\n\n  dbUpdater(url, data) {\n    let postdata = [];\n\n    for (let shift in data) {\n      postdata.push({\n        date: shift,\n        text: data[shift].text\n      });\n    }\n\n    fetch(url, {\n      method: 'POST',\n      body: JSON.stringify(postdata),\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      mode: 'cors'\n    }).then(res => res.json()).then(str => this.shiftupdateChecker(str));\n  }\n\n  shiftupdateChecker(str) {\n    if (str !== \"\") {\n      const list = [];\n\n      for (let data of this.state.isUpdateshift) {\n        if (data !== str) {\n          list.push(data);\n        }\n      }\n\n      if (list.length <= 0) {\n        //シフトデータ取得\n        fetch('/shiftdata') //fetch('/testshiftdata')\n        .then(res => res.json()).then(data => this.setdefaultshifts(data)); //コメントデータ取得\n\n        fetch('/getcommentdata') //fetch('/testgetcommentdata')\n        .then(res => res.json()).then(data => this.setdefaultcomment(data));\n      }\n\n      this.setState({\n        isUpdateshift: list\n      });\n    } else {\n      if (this.state.isUpdateshift.length <= 0) {\n        //シフトデータ取得\n        fetch('/shiftdata') //fetch('/testshiftdata')\n        .then(res => res.json()).then(data => this.setdefaultshifts(data)); //コメントデータ取得\n\n        fetch('/getcommentdata') //fetch('/testgetcommentdata')\n        .then(res => res.json()).then(data => this.setdefaultcomment(data));\n      }\n    }\n  }\n\n}\n\nexport default Home;","map":{"version":3,"sources":["C:\\Users\\03yuk\\Desktop\\private\\react\\shift-reserch3\\client\\src\\Home.js"],"names":["React","Component","Link","Calendar","Modal","withStyles","TextField","SettingIcon","customStyles","content","top","left","right","bottom","marginRight","transform","formcontrol","fontSize","calendarstyle","display","CssTextField","root","color","borderColor","setAppElement","Home","constructor","props","state","userdata","date","Date","receptionDate","stamp","stamptime","deadline","default_month_days","month_days","shifttimes","startTime","endTime","complementdaysText","wishdays","default_comments","comments","wishday","comment","nowprintcommentday","modalIsOpen","isUpdateshift","setdefaultshifts","bind","setdefaultcomment","getDateReception","dayspreOnclick","daysbackOnclick","dayspreback","wishdayOnchange","commentOnchange","openModal","afterOpenModal","closeModal","setShiftTime","startTimeChange","endTimeChange","addDataOnClick","shiftupdateChecker","componentDidMount","fetch","then","res","json","data","setState","render","username","margin","getFullYear","getMonth","getDate","onClickstamp","getTileContent","value","dayClick","map","days","time","getintdate","year","month","day","slice","deflist","list","shift","text","detail","num","recepdate","firstdate","com","wish","getFormatDate","receptionday","setday","finaldate","view","dayslist","clickday","clickdate","str","printday","datearr","substr","split","nowdate","e","target","alert","defshift","newshift","newshiftdata","shiftday","deleteshiftdata","updateshiftdata","length","concat","dbUpdater","addcommentdata","push","updatecommentdata","method","body","JSON","stringify","headers","mode","url","postdata"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport Calendar from 'react-calendar';\r\nimport Modal from 'react-modal';\r\nimport './css/Home.css';\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport SettingIcon from '@material-ui/icons/SettingsApplications';\r\n\r\n\r\nconst customStyles = {\r\n    content: {\r\n        top: '50%',\r\n        left: '50%',\r\n        right: 'auto',\r\n        bottom: 'auto',\r\n        marginRight: '-50%',\r\n        transform: 'translate(-50%, -50%)'\r\n    },\r\n    formcontrol: {\r\n        fontSize: '10px'\r\n    }\r\n};\r\nconst calendarstyle = {\r\n    content: {\r\n        display: 'inline-block'\r\n    }\r\n}\r\nconst CssTextField = withStyles({\r\n    root: {\r\n        '& label.Mui-focused': {\r\n            color: '#20C2D3',\r\n        },\r\n        '& .MuiOutlinedInput-root': {\r\n            '&.Mui-focused fieldset': {\r\n                borderColor: '#20C2D3',\r\n            },\r\n        },\r\n    },\r\n})(TextField);\r\n\r\nModal.setAppElement('#root')\r\n\r\nclass Home extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            userdata: [],//ユーザー情報\r\n            date: new Date(),//today\r\n            receptionDate: new Date(),//受付中\r\n            stamp: \"x\",//シフトに記入する文字\r\n            stamptime: \"\",//時間希望\r\n            deadline: \"\",//締め切り\r\n            default_month_days: [],//defaultのシフト情報\r\n            month_days: [],//更新されるシフト情報\r\n            shifttimes: [\"09:00\", \"09:30\", \"10:00\", \"10:30\", \"11:00\", \"11:30\", \"12:00\", \"12:30\",\r\n                \"13:00\", \"13:30\", \"14:00\", \"14:30\", \"15:00\", \"15:30\",\r\n                \"16:00\", \"16:30\", \"17:00\", \"17:30\", \"18:00\", \"18:30\",\r\n                \"19:00\", \"19:30\", \"20:00\", \"20:30\", \"21:00\", \"21:30\",\r\n                \"22:00\", \"22:30\", \"23:00\", \"23:30\", \"23:45\"],//選択可能時間\r\n            startTime: \"09:00\",\r\n            endTime: \"09:00\",\r\n            complementdaysText: \"\",\r\n            wishdays: [\"\", 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16],//選択希望日数\r\n            default_comments: [],//defaultのコメント\r\n            comments: [],//dbから\r\n            wishday: \"\",//希望日数\r\n            comment: \"\",//希望コメント\r\n            nowprintcommentday: \"\",\r\n            modalIsOpen: false,//モーダル判定\r\n            isUpdateshift: []//シフト更新\r\n        }\r\n        this.setdefaultshifts = this.setdefaultshifts.bind(this);\r\n        this.setdefaultcomment = this.setdefaultcomment.bind(this);\r\n        this.getDateReception = this.getDateReception.bind(this);\r\n        this.dayspreOnclick = this.dayspreOnclick.bind(this);\r\n        this.daysbackOnclick = this.daysbackOnclick.bind(this);\r\n        this.dayspreback = this.dayspreback.bind(this);\r\n        this.wishdayOnchange = this.wishdayOnchange.bind(this);\r\n        this.commentOnchange = this.commentOnchange.bind(this);\r\n        this.openModal = this.openModal.bind(this);\r\n        this.afterOpenModal = this.afterOpenModal.bind(this);\r\n        this.closeModal = this.closeModal.bind(this);\r\n        this.setShiftTime = this.setShiftTime.bind(this);\r\n        this.startTimeChange = this.startTimeChange.bind(this);\r\n        this.endTimeChange = this.endTimeChange.bind(this);\r\n        this.addDataOnClick = this.addDataOnClick.bind(this);\r\n        this.shiftupdateChecker = this.shiftupdateChecker.bind(this);\r\n\r\n    }\r\n    componentDidMount() {\r\n        this.getDateReception();\r\n        //ユーザーデータ取得\r\n        fetch('/userdata')\r\n            //fetch('/testuserdata')\r\n            .then(res => res.json())\r\n            .then(data => this.setState({ userdata: data }))\r\n        //シフトデータ取得\r\n        fetch('/shiftdata')\r\n            //fetch('/testshiftdata')\r\n            .then(res => res.json())\r\n            .then(data => this.setdefaultshifts(data))\r\n        //コメントデータ取得\r\n        fetch('/getcommentdata')\r\n            //fetch('/testgetcommentdata')\r\n            .then(res => res.json())\r\n            .then(data => this.setdefaultcomment(data))\r\n    }\r\n    render() {\r\n        return (\r\n            <div>\r\n                <h1>シフト希望</h1>\r\n                ようこそ{this.state.userdata.username}さん\r\n\r\n                <Link to=\"/Setting\">\r\n                    <SettingIcon\r\n                        style={{ margin: '5px', fontSize: '30px' }}\r\n                    >\r\n                    </SettingIcon></Link>\r\n                <a href=\"/logout\">\r\n                    ログアウト\r\n                </a>\r\n                <h2 className=\"reception\">{this.state.receptionDate.getFullYear()} {this.state.receptionDate.getMonth() + 1}月\r\n                {this.state.receptionDate.getDate()}日～受付中</h2>\r\n                <div id=\"dateText\">{this.state.deadline}</div>\r\n                <button className=\"wishbutton\" id=\"batu\" onClick={this.onClickstamp.bind(this, \"x\")}>✕</button>\r\n                <button className=\"wishbutton\" id=\"sankaku\" onClick={this.onClickstamp.bind(this, \"△\")}>△</button>\r\n                <button className=\"wishbutton\" id=\"timeset\" onClick={this.onClickstamp.bind(this, \"time\")}>時間指定</button>\r\n                <br />\r\n                <div id=\"calendar\">\r\n                    <Calendar\r\n                        locale=\"ja-JP\"\r\n                        calendarType=\"US\"\r\n                        value={this.state.receptionDate}\r\n                        tileContent={this.getTileContent.bind(this)}\r\n                        onChange={(value) => this.dayClick(value)}\r\n                    />\r\n                </div>\r\n                <div className=\"flame\">\r\n                    補足希望:{this.state.complementdaysText}\r\n                    <button onClick={this.dayspreOnclick} className=\"wishbutton\" id=\"prevwish\">◁</button>\r\n                    <button onClick={this.daysbackOnclick} className=\"wishbutton\" id=\"backwish\">▷</button>\r\n                    <br />\r\n                    <div id=\"wishday\">\r\n                        希望出勤日数：\r\n\r\n                    <select onChange={this.wishdayOnchange} value={this.state.wishday}>\r\n                            {this.state.wishdays.map(days =>\r\n                                <option key={days}>{days}</option>)}\r\n                        </select>日\r\n                    </div>\r\n\r\n                    <div>\r\n                        <CssTextField\r\n                            id=\"outlined-name\"\r\n                            label=\"追記\"\r\n                            value={this.state.comment}\r\n                            onChange={this.commentOnchange}\r\n                            margin=\"normal\"\r\n                            variant=\"outlined\"\r\n                            placeholder=\"希望を記入\"\r\n                        />\r\n                        <button id=\"submit_shiftdata\" onClick={this.addDataOnClick}>登録</button>\r\n                    </div>\r\n                </div>\r\n\r\n                <Modal\r\n                    isOpen={this.state.modalIsOpen}\r\n                    onAfterOpen={this.afterOpenModal}\r\n                    onRequestClose={this.closeModal}\r\n                    style={customStyles}\r\n                    contentLabel=\"worktime Modal\"\r\n                >\r\n                    <h2>出勤可能時間を選択</h2>\r\n                    <div>\r\n                        <select onChange={this.startTimeChange} value={this.state.startTime}>\r\n                            {this.state.shifttimes.map(time =>\r\n                                <option key={time}>{time}</option>\r\n                            )}\r\n                        </select>～\r\n                    <select onChange={this.endTimeChange} value={this.state.endTime}>\r\n                            {this.state.shifttimes.map(time =>\r\n                                <option key={time}>{time}</option>\r\n                            )}\r\n                        </select>\r\n                    </div>\r\n                    <button onClick={this.closeModal}>閉じる</button>\r\n                    <button onClick={this.setShiftTime}>決定</button>\r\n                </Modal>\r\n            </div>\r\n        );\r\n    }\r\n    getintdate(year, month, day) {\r\n        return year + (\"0\" + (month + 1)).slice(-2) + (\"0\" + day).slice(-2);\r\n    }\r\n    //json変換\r\n    setdefaultshifts(data) {\r\n        const deflist = [];\r\n        const list = [];\r\n        for (let shift of data) {\r\n            list[shift.date] = { text: shift.detail }\r\n            deflist[shift.date] = { text: shift.detail }\r\n        }\r\n        this.setState({\r\n            default_month_days: deflist,\r\n            month_days: list\r\n        })\r\n    }\r\n    //commentSetting\r\n    setdefaultcomment(data) {\r\n        if (data !== \"\") {\r\n            const deflist = [];\r\n            const list = [];\r\n            for (const comment of data) {\r\n                const date = new Date(comment.date);\r\n                const num = date.getFullYear() + (\"0\" + (date.getMonth() + 1)).slice(-2) + (\"0\" + date.getDate()).slice(-2);\r\n                list[num] = { comment: comment.text, wishday: comment.wishday }\r\n                deflist[num] = { comment: comment.text, wishday: comment.wishday }\r\n            }\r\n            //締め切りの初期コメント設定\r\n            const recepdate = this.state.receptionDate;\r\n            const firstdate = recepdate.getFullYear() + (\"0\" + (recepdate.getMonth() + 1)).slice(-2) + (\"0\" + recepdate.getDate()).slice(-2);\r\n            let com = \"\";\r\n            let wish = \"\";\r\n            if (list[firstdate] != null) {\r\n                com = list[firstdate].comment;\r\n                wish = list[firstdate].wishday;\r\n            }\r\n            this.setState({\r\n                default_comments: deflist,\r\n                comments: list,\r\n                comment: com,\r\n                wishday: wish,\r\n                nowprintcommentday: firstdate\r\n            })\r\n        }\r\n    }\r\n    getFormatDate(date) {\r\n        return `${date.getFullYear()}${('0' + (date.getMonth() + 1)).slice(-2)}${('0' + date.getDate()).slice(-2)}`;\r\n    }\r\n    //受付中日にち\r\n    getDateReception() {\r\n        let year = this.state.date.getFullYear();\r\n        let month = this.state.date.getMonth() + 1;\r\n        const day = this.state.date.getDate();\r\n        let receptionday = \"\";\r\n        let deadline = \"\";\r\n        let setday = \"\";\r\n        if (day <= 10) {\r\n            //締め切り\r\n            const finaldate = new Date(year, month, 0);\r\n            receptionday = month + \"/16～\" + month + \"/\" + finaldate.getDate();\r\n            deadline = month + \"/10まで(\" + receptionday + \")\"\r\n            //今月16～末日まで\r\n            setday = year + \"/\" + month + \"/16\";\r\n        } else if (day > 24) {\r\n            //年越し処理\r\n            if (month === 12) {\r\n                year++;\r\n                month = 0;\r\n            }\r\n            //締め切り\r\n            const finaldate = new Date(year, month, 0);\r\n            receptionday = (month + 1) + \"/16～\" + (month + 1) + \"/\" + finaldate.getDate();\r\n            deadline = (month + 1) + \"/10まで(\" + receptionday + \")\"\r\n            //来月16～末日\r\n            setday = year + \"/\" + (month + 1) + \"/16\";\r\n        } else {\r\n            //年越し処理\r\n            if (month === 12) {\r\n                year++;\r\n                month = 0;\r\n            }\r\n            //締め切り\r\n            receptionday = (month + 1) + \"/1～\" + (month + 1) + \"/15\";\r\n            deadline = month + \"/24まで(\" + receptionday + \")\"\r\n            //来月1～15まで\r\n            setday = year + \"/\" + (month + 1) + \"/1\";\r\n        }\r\n        this.setState({\r\n            complementdaysText: receptionday,\r\n            deadline: deadline,\r\n            receptionDate: new Date(setday)\r\n        })\r\n    }\r\n    getTileContent({ date, view }) {\r\n        // 月表示のときのみ\r\n        if (view !== 'month') {\r\n            return null;\r\n        }\r\n        const day = this.getFormatDate(date);\r\n        return (\r\n            <p className=\"calendaritem\">\r\n                {(this.state.month_days[day] && this.state.month_days[day].text) ?\r\n                    this.state.month_days[day].text : '  '\r\n                }\r\n            </p>\r\n        );\r\n    }\r\n\r\n    //スタンプ変換\r\n    onClickstamp(value) {\r\n        this.setState({\r\n            stamp: value\r\n        })\r\n    }\r\n    //日付クリック\r\n    dayClick(value) {\r\n        //受付中か\r\n        if (this.state.receptionDate <= value) {\r\n            const dayslist = this.state.month_days;\r\n            const clickday = value.getFullYear() + (\"0\" + (value.getMonth() + 1)).slice(-2) + (\"0\" + value.getDate()).slice(-2);\r\n            this.setState({ clickdate: clickday })\r\n            //空or重複判定\r\n            if (null == dayslist[clickday] || \"\" === dayslist[clickday].text) {\r\n                //stampが記号か日付で分岐\r\n                if (this.state.stamp === \"time\") {\r\n                    this.openModal();\r\n\r\n                } else {\r\n                    dayslist[clickday] = { text: this.state.stamp }\r\n                    this.setState({ month_days: dayslist })\r\n                }\r\n                //stamp一致クリック\r\n            } else if (this.state.stamp === dayslist[clickday].text) {\r\n                dayslist[clickday] = { text: \"\" }\r\n                this.setState({ month_days: dayslist })\r\n            } else if (this.state.stamp !== dayslist[clickday].text) {\r\n                //stampが記号か日付で分岐\r\n                if (this.state.stamp === \"time\") {\r\n                    //this.openModal();\r\n                    dayslist[clickday] = { text: \"\" }\r\n                } else {\r\n                    dayslist[clickday] = { text: this.state.stamp }\r\n                    this.setState({ month_days: dayslist })\r\n                }\r\n            }\r\n        }\r\n    }\r\n    dayspreOnclick() {\r\n        //前へ処理\r\n        this.dayspreback(\"pre\");\r\n    }\r\n    daysbackOnclick() {\r\n        //後へ処理\r\n        this.dayspreback(\"back\")\r\n    }\r\n    dayspreback(str) {\r\n        this.state.comments[this.state.nowprintcommentday] = {\r\n            comment: this.state.comment,\r\n            wishday: this.state.wishday\r\n        }\r\n        //nowprintcommentday\r\n        const printday = this.state.nowprintcommentday;\r\n        const datearr = (printday.substr(0, 4) + '/' + printday.substr(4, 2) + '/' + printday.substr(6, 2)).split('/');\r\n        const nowdate = new Date(datearr[0], datearr[1] - 1, datearr[2]);\r\n        let year = nowdate.getFullYear();\r\n        let month = nowdate.getMonth();\r\n        let day = nowdate.getDate();\r\n\r\n\r\n        if (str === \"pre\") {\r\n            if (day === 16) {\r\n                day = 1;\r\n            } else {\r\n                if (month === 0) {\r\n                    year--;\r\n                    month = 11;\r\n                    day = 16;\r\n                } else {\r\n                    month--;\r\n                    day = 16;\r\n                }\r\n            }\r\n        } else if (str === \"back\") {\r\n            //\r\n            if (day === 1) {\r\n                day = 16;\r\n            } else {\r\n                if (month === 11) {\r\n                    year++;\r\n                    month = 0;\r\n                    day = 1;\r\n                } else {\r\n                    month++;\r\n                    day = 1;\r\n                }\r\n            }\r\n        }\r\n        //complementdaysText\r\n        let text = \"\";\r\n        if (day === 16) {\r\n            const finaldate = new Date(year, month, 0);\r\n            text = (month + 1) + \"/\" + day + \"～\" + (month + 1) + \"/\" + finaldate.getDate();\r\n        } else {\r\n            text = (month + 1) + \"/\" + day + \"～\" + (month + 1) + \"/\" + 15;\r\n        }\r\n        if (this.state.comments[this.getintdate(year, month, day)] == null) {\r\n            this.state.comments[this.getintdate(year, month, day)] = {\r\n                comment: \"\",\r\n                wishday: \"\"\r\n            }\r\n        }\r\n        this.setState({\r\n            comment: this.state.comments[this.getintdate(year, month, day)].comment,\r\n            wishday: this.state.comments[this.getintdate(year, month, day)].wishday,\r\n            nowprintcommentday: this.getintdate(year, month, day),\r\n            complementdaysText: text\r\n        })\r\n    }\r\n    wishdayOnchange(e) {\r\n        this.setState({\r\n            wishday: e.target.value\r\n        })\r\n    }\r\n    commentOnchange(e) {\r\n        this.setState({\r\n            comment: e.target.value\r\n        });\r\n    }\r\n\r\n    //モーダル関連\r\n    openModal() {\r\n        this.setState({ modalIsOpen: true });\r\n    }\r\n    afterOpenModal() {\r\n        //モーダルオープン後処理\r\n    }\r\n    closeModal() {\r\n        this.setState({ modalIsOpen: false });\r\n    }\r\n    setShiftTime() {\r\n        if (this.state.startTime >= this.state.endTime) {\r\n            alert(\"不可能な時間です\")\r\n        } else {\r\n            this.closeModal();\r\n            const dayslist = this.state.month_days;\r\n            dayslist[this.state.clickdate] = { text: this.state.startTime + \"-\" + this.state.endTime }\r\n            this.setState({ month_days: dayslist });\r\n        }\r\n    }\r\n    startTimeChange(e) {\r\n        this.setState({\r\n            startTime: e.target.value\r\n        })\r\n    }\r\n    endTimeChange(e) {\r\n        this.setState({\r\n            endTime: e.target.value\r\n        })\r\n    }\r\n    //登録ボタン\r\n    addDataOnClick() {\r\n        this.state.comments[this.state.nowprintcommentday] = {\r\n            comment: this.state.comment,\r\n            wishday: this.state.wishday\r\n        }\r\n        const defshift = this.state.default_month_days;\r\n        const newshift = this.state.month_days;\r\n        const newshiftdata = [];\r\n        //追加されたシフト情報\r\n        for (let shiftday in newshift) {\r\n            if (defshift[shiftday] == null) {\r\n                newshiftdata[shiftday] = { text: newshift[shiftday].text }\r\n            }\r\n        }\r\n        //削除されたシフト情報\r\n        const deleteshiftdata = [];\r\n        for (let shiftday in defshift) {\r\n            if (newshift[shiftday].text === \"\") {\r\n                deleteshiftdata[shiftday] = { text: defshift[shiftday].text }\r\n            }\r\n        }\r\n        //更新されたシフト情報\r\n        const updateshiftdata = [];\r\n        for (let shiftday in newshift) {\r\n            if (defshift[shiftday] != null && newshift[shiftday].text !== \"\" && defshift[shiftday].text !== newshift[shiftday].text) {\r\n                updateshiftdata[shiftday] = { text: newshift[shiftday].text }\r\n            }\r\n        }\r\n        //add\r\n        if (newshiftdata.length > 0) {\r\n            this.setState({ isUpdateshift: this.state.isUpdateshift.concat(\"add\") });\r\n            this.dbUpdater('/addshiftdata', newshiftdata);\r\n            //this.dbUpdater('/testaddshiftdata', newshiftdata);\r\n        }\r\n        //delete\r\n        if (deleteshiftdata.length > 0) {\r\n            this.setState({ isUpdateshift: this.state.isUpdateshift.concat(\"delete\") });\r\n            this.dbUpdater('/deleteshiftdata', deleteshiftdata);\r\n            //this.dbUpdater('/testdeleteshiftdata', deleteshiftdata);\r\n        }\r\n        //update\r\n        if (updateshiftdata.length > 0) {\r\n            this.setState({ isUpdateshift: this.state.isUpdateshift.concat(\"update\") });\r\n            this.dbUpdater('/updateshiftdata', updateshiftdata);\r\n            //this.dbUpdater('/testupdateshiftdata', updateshiftdata);\r\n        }\r\n        //コメント更新\r\n        //差分配列add＆update配列生成のちfetch\r\n        const addcommentdata = [];\r\n        for (const com in this.state.comments) {\r\n            if (this.state.default_comments[com] == null) {\r\n                addcommentdata.push({\r\n                    date: com,\r\n                    comment: this.state.comments[com].comment,\r\n                    wishday: this.state.comments[com].wishday\r\n                })\r\n            }\r\n        }\r\n        const updatecommentdata = [];\r\n        for (const com in this.state.default_comments) {\r\n            if ((this.state.comments[com].comment !== this.state.default_comments[com].comment) ||\r\n                (this.state.comments[com].wishday !== this.state.default_comments[com].wishday)) {\r\n                updatecommentdata.push({\r\n                    date: com,\r\n                    comment: this.state.comments[com].comment,\r\n                    wishday: this.state.comments[com].wishday\r\n                })\r\n            }\r\n        }\r\n        fetch('/updatecommentdata', {\r\n            //fetch('/testupdatecommentdata', {\r\n            method: 'POST',\r\n            body: JSON.stringify(updatecommentdata),\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            mode: 'cors'\r\n        }).then(res => res.json())\r\n        fetch('/addcommentdata', {\r\n            //fetch('/testaddcommentdata', {\r\n            method: 'POST',\r\n            body: JSON.stringify(addcommentdata),\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            mode: 'cors'\r\n        }).then(res => res.json())\r\n            .then(str => alert(\"登録しました\"))\r\n        this.shiftupdateChecker(\"\");\r\n    }\r\n\r\n    //shiftDB更新用fetch\r\n    dbUpdater(url, data) {\r\n        let postdata = [];\r\n        for (let shift in data) {\r\n            postdata.push({ date: shift, text: data[shift].text })\r\n        }\r\n        fetch(url, {\r\n            method: 'POST',\r\n            body: JSON.stringify(postdata),\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            mode: 'cors'\r\n        }).then(res => res.json())\r\n            .then(str => this.shiftupdateChecker(str))\r\n    }\r\n    shiftupdateChecker(str) {\r\n        if (str !== \"\") {\r\n            const list = [];\r\n            for (let data of this.state.isUpdateshift) {\r\n                if (data !== str) {\r\n                    list.push(data);\r\n                }\r\n            }\r\n            if (list.length <= 0) {\r\n                //シフトデータ取得\r\n                fetch('/shiftdata')\r\n                    //fetch('/testshiftdata')\r\n                    .then(res => res.json())\r\n                    .then(data => this.setdefaultshifts(data))\r\n                //コメントデータ取得\r\n                fetch('/getcommentdata')\r\n                    //fetch('/testgetcommentdata')\r\n                    .then(res => res.json())\r\n                    .then(data => this.setdefaultcomment(data))\r\n            }\r\n            this.setState({ isUpdateshift: list });\r\n        } else {\r\n            if (this.state.isUpdateshift.length <= 0) {\r\n                //シフトデータ取得\r\n                fetch('/shiftdata')\r\n                    //fetch('/testshiftdata')\r\n                    .then(res => res.json())\r\n                    .then(data => this.setdefaultshifts(data))\r\n                //コメントデータ取得\r\n                fetch('/getcommentdata')\r\n                    //fetch('/testgetcommentdata')\r\n                    .then(res => res.json())\r\n                    .then(data => this.setdefaultcomment(data))\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport default Home;"]},"metadata":{},"sourceType":"module"}