{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\03yuk\\\\Desktop\\\\private\\\\react\\\\shift-reserch3\\\\client\\\\src\\\\Wishlist.js\";\nimport React, { Component } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableRow from '@material-ui/core/TableRow';\nimport Paper from '@material-ui/core/Paper';\nconst useStyles = makeStyles(theme => ({\n  root: {\n    width: '100%',\n    marginTop: theme.spacing(3),\n    overflowX: 'auto'\n  },\n  table: {\n    minWidth: 650\n  }\n}));\n\nclass Wishlist extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      query: this.props.location.query,\n      accessable: false,\n      //アクセス判定\n      memberlist: [],\n      //登録メンバー\n      allshiftdata: [],\n      //全シフト情報\n      printlist: [],\n      //表示するリスト\n      deadlineearly: 10,\n      deallinelate: 24,\n      startdate: \"\",\n      printdays: [] //表示する期間\n\n    };\n    this.setprintDays = this.setprintDays.bind(this);\n    this.sortmembershift = this.sortmembershift.bind(this);\n  }\n\n  componentDidMount() {\n    //アクセス判定\n    if (this.props.location.query !== undefined) {\n      if (this.props.location.query.pass === \"administer\") {\n        this.setState({\n          accessable: true\n        });\n        this.setprintDays(); //全ユーザー取得\n\n        fetch('/testmemberlist') //fetch('/memberlist')\n        .then(res => res.json()).then(list => {\n          this.setState({\n            memberlist: list\n          }); //全シフト情報取得\n\n          fetch('/testallshiftdata') //fetch('/allshiftdata')\n          .then(res => res.json()).then(data => {\n            this.setState({\n              allshiftdata: data\n            });\n            this.sortmembershift(list, data);\n          });\n        });\n      }\n    }\n  }\n\n  render() {\n    const classes = useStyles;\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70\n      },\n      __self: this\n    }, this.state.accessable ? React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73\n      },\n      __self: this\n    }, \"Wishlist\"), \"\\u30A2\\u30AF\\u30BB\\u30B9\\u53EF\\u80FD\", React.createElement(Paper, {\n      className: classes.root,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75\n      },\n      __self: this\n    }, React.createElement(Table, {\n      className: classes.table,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76\n      },\n      __self: this\n    }, React.createElement(TableHead, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77\n      },\n      __self: this\n    }, React.createElement(TableRow, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78\n      },\n      __self: this\n    }, React.createElement(TableCell, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79\n      },\n      __self: this\n    }, \"name\"), this.state.printdays.map(day => React.createElement(TableCell, {\n      key: day,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81\n      },\n      __self: this\n    }, day)))), React.createElement(TableBody, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, this.state.printlist.map(member => React.createElement(TableRow, {\n      key: member.name,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    }, React.createElement(TableCell, {\n      component: \"th\",\n      scope: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }, member.name), member.shift.map(shift => React.createElement(TableCell, {\n      component: \"th\",\n      scope: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    }, shift)))))))) : React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, \"\\u30A2\\u30AF\\u30BB\\u30B9\\u3067\\u304D\\u307E\\u305B\\u3093\"));\n  } //表示期間計算\n\n\n  setprintDays() {\n    //表示する期間開始日を計算\n    const date = new Date();\n    const year = date.getFullYear();\n    const month = date.getMonth();\n    const day = date.getDate();\n    let startdate = \"\";\n\n    if (day < this.state.deadlineearly) {\n      startdate = new Date(year, month, 1);\n    } else if (day < this.state.deallinelate) {\n      startdate = new Date(year, month, 16);\n    } else if (day >= this.state.deallinelate) {\n      if (month === 11) {\n        startdate = new Date(year + 1, month + 1, 1);\n      } else {\n        startdate = new Date(year, month + 1, 1);\n      }\n    } //date確認用\n    //startdate = new Date(2019, 7, 16);\n    //表示する期間配列生成\n\n\n    const days = [];\n\n    if (startdate.getDate() === 1) {\n      for (let i = 0; i < 15; i++) {\n        days.push(startdate.getMonth() + 1 + \"/\" + (startdate.getDate() + i));\n      }\n    } else if (startdate.getDate() === 16) {\n      const findate = new Date(startdate.getFullYear(), startdate.getMonth() + 1, 0);\n\n      for (let i = 0; i < findate.getDate() - startdate.getDate() + 1; i++) {\n        days.push(startdate.getMonth() + 1 + \"/\" + (startdate.getDate() + i));\n      }\n    }\n\n    this.setState({\n      startdate: startdate,\n      printdays: days\n    });\n  } //\n\n\n  sortmembershift(members, shifts) {\n    const printdate = this.state.startdate;\n    let printfinaldate = \"\";\n    let shiftlist = [];\n\n    if (printdate.getDate() === 1) {\n      printfinaldate = new Date(printdate.getFullYear(), printdate.getMonth(), 15);\n      shiftlist = Array(15); //shiftlist.fill(\"a\");\n    } else if (printdate.getDate() === 16) {\n      printfinaldate = new Date(printdate.getFullYear(), printdate.getMonth(), 0);\n      shiftlist = Array(printfinaldate.getDate() - 15); //shiftlist.fill(\"a\");\n    }\n\n    console.log(printfinaldate);\n    const membertoshift = [];\n\n    for (const member of members) {\n      //console.log(member);\n      const myshift = shiftlist;\n      myshift.fill(\"/\");\n      console.log(myshift);\n\n      for (const shift of shifts) {\n        if (shift.userid === member.userid) {\n          const sd = String(shift.date);\n          const shiftyear = parseInt(sd.slice(0, 4));\n          const shiftmonth = parseInt(sd.slice(4, 6));\n          const shiftday = parseInt(sd.slice(6)); //console.log(shiftyear + \"/\" + shiftmonth + \"/\" + shiftday);\n          //console.log(shiftday <= printfinaldate.getDate());\n\n          if (shiftyear === printdate.getFullYear() && shiftmonth === printdate.getMonth() + 1 && shiftday >= printdate.getDate() && shiftday <= printfinaldate.getDate()) {\n            //表示する情報\n            //console.log(shiftday - printdate.getDate());\n            console.log(\"add\");\n            myshift[shiftday - printdate.getDate()] = shift.detail;\n          }\n        }\n      } //console.log(myshift);\n\n\n      membertoshift.push({\n        name: member.name,\n        shift: myshift\n      });\n    } //\n\n\n    this.setState({\n      printlist: membertoshift\n    });\n  }\n\n}\n\nexport default Wishlist;","map":{"version":3,"sources":["C:\\Users\\03yuk\\Desktop\\private\\react\\shift-reserch3\\client\\src\\Wishlist.js"],"names":["React","Component","makeStyles","Table","TableBody","TableCell","TableHead","TableRow","Paper","useStyles","theme","root","width","marginTop","spacing","overflowX","table","minWidth","Wishlist","constructor","props","state","query","location","accessable","memberlist","allshiftdata","printlist","deadlineearly","deallinelate","startdate","printdays","setprintDays","bind","sortmembershift","componentDidMount","undefined","pass","setState","fetch","then","res","json","list","data","render","classes","map","day","member","name","shift","date","Date","year","getFullYear","month","getMonth","getDate","days","i","push","findate","members","shifts","printdate","printfinaldate","shiftlist","Array","console","log","membertoshift","myshift","fill","userid","sd","String","shiftyear","parseInt","slice","shiftmonth","shiftday","detail"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\n\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport Paper from '@material-ui/core/Paper';\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n    root: {\r\n        width: '100%',\r\n        marginTop: theme.spacing(3),\r\n        overflowX: 'auto',\r\n    },\r\n    table: {\r\n        minWidth: 650,\r\n    },\r\n}));\r\n\r\nclass Wishlist extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            query: this.props.location.query,\r\n            accessable: false,//アクセス判定\r\n            memberlist: [],//登録メンバー\r\n            allshiftdata: [],//全シフト情報\r\n            printlist: [],//表示するリスト\r\n            deadlineearly: 10,\r\n            deallinelate: 24,\r\n            startdate: \"\",\r\n            printdays: []//表示する期間\r\n        }\r\n\r\n        this.setprintDays = this.setprintDays.bind(this);\r\n        this.sortmembershift = this.sortmembershift.bind(this);\r\n    }\r\n    componentDidMount() {\r\n        //アクセス判定\r\n        if (this.props.location.query !== undefined) {\r\n            if (this.props.location.query.pass === \"administer\") {\r\n                this.setState({\r\n                    accessable: true\r\n                })\r\n                this.setprintDays();\r\n                //全ユーザー取得\r\n                fetch('/testmemberlist')\r\n                    //fetch('/memberlist')\r\n                    .then(res => res.json())\r\n                    .then(list => {\r\n                        this.setState({ memberlist: list })\r\n                        //全シフト情報取得\r\n                        fetch('/testallshiftdata')\r\n                            //fetch('/allshiftdata')\r\n                            .then(res => res.json())\r\n                            .then(data => {\r\n                                this.setState({ allshiftdata: data });\r\n                                this.sortmembershift(list, data);\r\n                            })\r\n                    })\r\n\r\n            }\r\n        }\r\n    }\r\n    render() {\r\n        const classes = useStyles;\r\n        return (\r\n            <div>\r\n                {this.state.accessable ? (\r\n                    <div>\r\n                        <h1>Wishlist</h1>\r\n                        アクセス可能\r\n                        <Paper className={classes.root}>\r\n                            <Table className={classes.table}>\r\n                                <TableHead>\r\n                                    <TableRow>\r\n                                        <TableCell>name</TableCell>\r\n                                        {this.state.printdays.map((day) =>\r\n                                            <TableCell key={day}>{day}</TableCell>\r\n                                        )}\r\n                                    </TableRow>\r\n                                </TableHead>\r\n                                <TableBody>\r\n                                    {this.state.printlist.map(member =>\r\n                                        <TableRow key={member.name}>\r\n                                            <TableCell component=\"th\" scope=\"row\">{member.name}</TableCell>\r\n                                            {member.shift.map(shift =>\r\n                                                <TableCell component=\"th\" scope=\"row\">{shift}</TableCell>)}\r\n                                        </TableRow>\r\n                                    )}\r\n                                </TableBody>\r\n                            </Table>\r\n                        </Paper>\r\n                    </div>\r\n                ) : (\r\n                        <div>アクセスできません</div>\r\n                    )}\r\n            </div>\r\n\r\n        );\r\n    }\r\n    //表示期間計算\r\n    setprintDays() {\r\n        //表示する期間開始日を計算\r\n        const date = new Date();\r\n        const year = date.getFullYear();\r\n        const month = date.getMonth();\r\n        const day = date.getDate();\r\n        let startdate = \"\";\r\n        if (day < this.state.deadlineearly) {\r\n            startdate = new Date(year, month, 1);\r\n        } else if (day < this.state.deallinelate) {\r\n            startdate = new Date(year, month, 16);\r\n        } else if (day >= this.state.deallinelate) {\r\n            if (month === 11) {\r\n                startdate = new Date(year + 1, month + 1, 1);\r\n            } else {\r\n                startdate = new Date(year, month + 1, 1);\r\n            }\r\n        }\r\n        //date確認用\r\n        //startdate = new Date(2019, 7, 16);\r\n\r\n        //表示する期間配列生成\r\n        const days = [];\r\n        if (startdate.getDate() === 1) {\r\n            for (let i = 0; i < 15; i++) {\r\n                days.push((startdate.getMonth() + 1) + \"/\" + (startdate.getDate() + i));\r\n            }\r\n        } else if (startdate.getDate() === 16) {\r\n            const findate = new Date(startdate.getFullYear(), startdate.getMonth() + 1, 0);\r\n            for (let i = 0; i < findate.getDate() - startdate.getDate() + 1; i++) {\r\n                days.push((startdate.getMonth() + 1) + \"/\" + (startdate.getDate() + i));\r\n            }\r\n        }\r\n        this.setState({\r\n            startdate: startdate,\r\n            printdays: days\r\n        });\r\n    }\r\n    //\r\n    sortmembershift(members, shifts) {\r\n        const printdate = this.state.startdate;\r\n        let printfinaldate = \"\";\r\n        let shiftlist = [];\r\n        if (printdate.getDate() === 1) {\r\n            printfinaldate = new Date(printdate.getFullYear(), printdate.getMonth(), 15)\r\n            shiftlist = Array(15);\r\n            //shiftlist.fill(\"a\");\r\n        } else if (printdate.getDate() === 16) {\r\n            printfinaldate = new Date(printdate.getFullYear(), printdate.getMonth(), 0);\r\n            shiftlist = Array(printfinaldate.getDate() - 15);\r\n            //shiftlist.fill(\"a\");\r\n        }\r\n        console.log(printfinaldate);\r\n        const membertoshift = [];\r\n\r\n        for (const member of members) {\r\n            //console.log(member);\r\n            const myshift = shiftlist;\r\n            myshift.fill(\"/\");\r\n            console.log(myshift);\r\n            for (const shift of shifts) {\r\n                if (shift.userid === member.userid) {\r\n                    const sd = String(shift.date);\r\n                    const shiftyear = parseInt(sd.slice(0, 4));\r\n                    const shiftmonth = parseInt(sd.slice(4, 6));\r\n                    const shiftday = parseInt(sd.slice(6));\r\n                    //console.log(shiftyear + \"/\" + shiftmonth + \"/\" + shiftday);\r\n                    //console.log(shiftday <= printfinaldate.getDate());\r\n                    if ((shiftyear === printdate.getFullYear()) &&\r\n                        (shiftmonth === (printdate.getMonth() + 1)) &&\r\n                        (shiftday >= printdate.getDate()) &&\r\n                        (shiftday <= printfinaldate.getDate())) {\r\n                        //表示する情報\r\n                        //console.log(shiftday - printdate.getDate());\r\n                        console.log(\"add\");\r\n                        myshift[shiftday - printdate.getDate()] = shift.detail;\r\n                    }\r\n                }\r\n            }\r\n            //console.log(myshift);\r\n            membertoshift.push({\r\n                name: member.name,\r\n                shift: myshift\r\n            })\r\n        }\r\n        //\r\n        this.setState({\r\n            printlist: membertoshift\r\n        });\r\n    }\r\n}\r\n\r\nexport default Wishlist;"]},"metadata":{},"sourceType":"module"}